# GenELPA: A easy-to-use ELPA interface to solve generalized eigenvalue problems

GenELPA是使用ELPA作为计算核心求解广义本征值的工具。

[ELPA](https://elpa.mpcdf.mpg.de/index.html)是一种高性能的、尤其在大规模并行时效率特别高的本征值求解器，在多种第一性原理计算软件中都有应用。该程序是马普研究所开发，核心程序由FORTRAN编写，并提供了C的接口。

从2011年第一版发布以来，ELPA先后使用了两种API，一种是2016.05.004以及之前的版本使用的传统接口；另一种是2016.11.001以及之后版本使用的采用handle来传递计算配置参数的新接口。采用新接口以后，ELPA增加了直接求解广义本征值的函数和对GPU的支持。

我们之前曾经针对ELPA做过一个求解广义本征值的扩展程序GenELPA，它提供了直接求解广义本征值的函数以及分步求解的功能，并增强了在求解各种矩阵时的健壮性。在[ABACUS](https://abacus.ustc.edu.cn/)中，该程序能够稳定工作。

新接口的ELPA已经支持广义本征值的直接求解，但我们在使用过程中发现存在以下问题：

1. 在求解某些矩阵时计算不太稳定；
2. 某些情况下会有不必要的屏幕输出（2021.05.002版）。

因此，我们在原有GenELPA的基础上，重新编写了能够支持广义本征值求解的程序，并解决了这两个问题。同时，考虑到旧版API的ELPA仍然有广泛的应用，我们在新的程序中也支持了旧版API的ELPA。为了兼容性和易于使用，我们保持了新旧版本的调用方式一致，这样使用ELPA的程序无需更改源代码，只需在编译时链接不同的库文件，即可支持新旧不同API的ELPA。

我们还增加了自动根据运行服务器的CPU参数选择求解kernel的功能，用户在使用默认kernel时即可获得较好的计算效率。
